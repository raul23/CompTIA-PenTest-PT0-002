====================================
Lab Exercises: Information gathering
====================================

.. contents:: **Contents**
   :depth: 5
   :local:
   :backlinks: top

Book: CompTIA Pentest+ Certification For Dummies (2nd ed., 2022)
================================================================
Exercise 3-1: Conduct a Whois Search with ARIN
----------------------------------------------
`:information_source:` using **www.arin.net/whois** to get information about an organization

1. Search for an organization
2. Click on the link for the Handle **"MICRO-218"**
3. At the bottom of the results, the entry **"Net Range"** gives the **public IPs** for the organization

   These are the public IP blocks that need to be documented in the pentest report.

Exercise 3-2: Use ``theHarvester`` to collect email addresses
-------------------------------------------------------------
`:information_source:` using ``theHarvester`` to collect email addresses and hosts IP addresses for an organization

On a terminal:

.. code-block::
   
   $ theharvester -d example.com -b all

The email and IP address need to be documented in the pentest report.

Exercise 3-3: Use Shodan to discover systems on the Internet
------------------------------------------------------------
`:information_source:` 
 
 - using **shodan.io** to discover systems and information about systems on the Internet for an organization
 - You need to register to use **shodan.io**
 - The "View on Map" tab is only available if you become a member 

1. Search for an organization
2. When clicking on an IP address, you can get lots of info about the organization such as:

   - Country, City, Organization, ISP, ASN
   - Vulnerabilities (list of CVEs), e.g.::
   
     
      CVE-2021-31806	An issue was discovered in Squid before 4.15 and 5.x before 5.0.6. Due to a 
                        memory-management bug, it is vulnerable to a Denial of Service attack (against 
                        all clients using the proxy) via HTTP Range request processing.
   - Open Ports
   - The output from the server when connecting to an open port, e.g.::
  
      HTTP/1.1 400 Bad Request
      Server: squid/4.14
      Mime-Version: 1.0
      Date: Thu, 16 Feb 2023 19:07:45 GMT
      Content-Type: text/html;charset=utf-8
      Content-Length: 16
      X-Squid-Error: ERR_INVALID_URL 0

